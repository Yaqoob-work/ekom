!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(require("video.js")):"function"==typeof define&&define.amd?define(["video.js"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).videojs)}(this,(function(e){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var l=t(e),i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function n(e){if(e.__esModule)return e;var t=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(e).forEach((function(l){var i=Object.getOwnPropertyDescriptor(e,l);Object.defineProperty(t,l,i.get?i:{enumerable:!0,get:function(){return e[l]}})})),t}var s,o=void 0!==i?i:"undefined"!=typeof window?window:{},u=n(Object.freeze({__proto__:null,default:{}}));"undefined"!=typeof document?s=document:(s=o["__GLOBAL_DOCUMENT_CACHE@4"])||(s=o["__GLOBAL_DOCUMENT_CACHE@4"]=u);var a=s;class r{constructor(e){let t=this;if(l.default.browser.IS_IE8){t=a.createElement("custom");for(const e in r.prototype)"constructor"!==e&&(t[e]=r.prototype[e])}return t.id=e.id,t.label=t.id,t.width=e.width,t.height=e.height,t.bitrate=e.bandwidth,t.enabled_=e.enabled,Object.defineProperty(t,"enabled",{get:()=>t.enabled_(),set(e){t.enabled_(e)}}),t}}class d extends l.default.EventTarget{constructor(){super();let e=this;if(l.default.browser.IS_IE8){e=a.createElement("custom");for(const t in d.prototype)"constructor"!==t&&(e[t]=d.prototype[t])}return e.levels_=[],e.selectedIndex_=-1,Object.defineProperty(e,"selectedIndex",{get:()=>e.selectedIndex_}),Object.defineProperty(e,"length",{get:()=>e.levels_.length}),e}addQualityLevel(e){let t=this.getQualityLevelById(e.id);if(t)return t;const l=this.levels_.length;return t=new r(e),""+l in this||Object.defineProperty(this,l,{get(){return this.levels_[l]}}),this.levels_.push(t),this.trigger({qualityLevel:t,type:"addqualitylevel"}),t}removeQualityLevel(e){let t=null;for(let l=0,i=this.length;l<i;l++)if(this[l]===e){t=this.levels_.splice(l,1)[0],this.selectedIndex_===l?this.selectedIndex_=-1:this.selectedIndex_>l&&this.selectedIndex_--;break}return t&&this.trigger({qualityLevel:e,type:"removequalitylevel"}),t}getQualityLevelById(e){for(let t=0,l=this.length;t<l;t++){const l=this[t];if(l.id===e)return l}return null}dispose(){this.selectedIndex_=-1,this.levels_.length=0}}d.prototype.allowedEvents_={change:"change",addqualitylevel:"addqualitylevel",removequalitylevel:"removequalitylevel"};for(const e in d.prototype.allowedEvents_)d.prototype["on"+e]=null;const h=l.default.getComponent("MenuButton"),c=l.default.getComponent("Menu"),y=l.default.getComponent("Component"),f=l.default.dom;class p extends h{constructor(e){super(e,{title:e.localize("Quality"),name:"QualityButton"})}createItems(){return[]}createMenu(){const e=new c(this.player_,{menuButton:this});if(this.hideThreshold_=0,this.options_.title){const l=f.createEl("li",{className:"vjs-menu-title",innerHTML:(t=this.options_.title,"string"!=typeof t?t:t.charAt(0).toUpperCase()+t.slice(1)),tabIndex:-1}),i=new y(this.player_,{el:l});this.hideThreshold_+=1,e.addItem(i)}var t;if(this.items=this.createItems(),this.items)for(let t=0;t<this.items.length;t++)e.addItem(this.items[t]);return e}}const v=l.default.getComponent("MenuItem");class g extends v{constructor(e,t,l,i){super(e,{label:t.label,selectable:!0,selected:t.selected||!1}),this.item=t,this.qualityButton=l,this.plugin=i}handleClick(){for(let e=0;e<this.qualityButton.items.length;++e)this.qualityButton.items[e].selected(!1);this.plugin.setQuality(this.item.value),this.selected(!0)}}const _=l.default.getPlugin("plugin");l.default.registerPlugin("qualitymenu",class extends _{constructor(e,t){super(e,t);const l=e.qualityLevels,i=new d,n=function(){i.dispose(),e.qualityLevels=l,e.off("dispose",n)};e.on("dispose",n),e.qualityLevels=()=>i,e.ready((()=>{this.createQualityButton()})),this.onAddQualityLevelRef=()=>this.onAddQualityLevel(),this.player.qualityLevels().on("addqualitylevel",this.onAddQualityLevelRef)}createQualityButton(){const e=this.player;this._qualityButton=new p(e);const t=e.controlBar.children().length-2,l=e.controlBar.addChild(this._qualityButton,{componentClass:"qualitySelector"},t);l.addClass("vjs-quality-selector"),this.setButtonInnerText("auto"),l.removeClass("vjs-hidden")}setButtonInnerText(e){this._qualityButton.menuButton_.$(".vjs-icon-placeholder").innerHTML=e}getQualityMenuItem(e){const t=this.player;return new g(t,e,this._qualityButton,this)}onAddQualityLevel(){const e=this.player,t=e.qualityLevels().levels_||[],l=[];let i=!1;for(let e=0;e<t.length;++e)if(t[e].height&&!l.filter((l=>l.item&&l.item.value===t[e].height)).length){"auto"==t[e].height&&(i=!0);const n=this.getQualityMenuItem.call(this,{label:"auto"==t[e].height?t[e].height:t[e].height+"p",value:t[e].height});l.push(n)}l.sort(((e,t)=>"object"!=typeof e||"object"!=typeof t||e.item.value<t.item.value?-1:e.item.value>t.item.value?1:0)),i||l.push(this.getQualityMenuItem.call(this,{label:e.localize("Auto"),value:"auto",selected:!0})),this._qualityButton&&(this._qualityButton.createItems=function(){return l},this._qualityButton.update())}setQuality(e){const t=this.player.qualityLevels();this._currentQuality=e,this.setButtonInnerText("auto"===e?e:`${e}p`);const l=t.levels_.filter((t=>t.height!==e)),i=t.levels_.filter((t=>t.height==e))[0];l.forEach((e=>{e.enabled=!1})),i.enabled=!0,this._qualityButton.unpressButton()}getCurrentQuality(){return this._currentQuality||"auto"}})}));
